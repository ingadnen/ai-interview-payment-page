<!DOCTYPE html>
<html>
<head>
    <title>AI Interview Reply - Purchase Session</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://www.paypal.com/sdk/js?client-id=AZ_C1HPDgcOrEGFT9zOzZJ5OCujGECLEiLC-BiUtrl1_Q2OgX_69304wgCgmF1KAyC20QlPAgiJl1cSO&currency=CAD"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; background-color: #f0f2f5; margin: 0; }
        .container { max-width: 400px; width: 100%; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; margin-bottom: 1.5rem; }
        .payment-option { margin-bottom: 1rem; text-align: center; }
        .payment-option b { display: block; margin-bottom: 0.5rem; color: #555; }
        #message { margin-top: 1.5rem; font-weight: bold; text-align: center; color: #28a745; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Choose Your Plan</h1>
        <p id="message"></p>
        <div class="payment-option"><b>60 Minutes - $20 CAD</b><div id="paypal-button-container-20"></div></div>
        <hr/>
        <div class="payment-option"><b>90 Minutes - $27 CAD</b><div id="paypal-button-container-27"></div></div>
        <hr/>
        <div class="payment-option"><b>120 Minutes - $36 CAD</b><div id="paypal-button-container-36"></div></div>
        <hr/>
        <div class="payment-option"><b>150 Minutes - $43 CAD</b><div id="paypal-button-container-43"></div></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const userId = urlParams.get('uid');
            const messageEl = document.getElementById('message');

            if (!userId) {
                console.error("User ID not found.");
                messageEl.textContent = "Error: User ID not found. Please return to the extension.";
                messageEl.style.color = "red";
                return;
            }

            function renderPayPalButton(containerId, description, value) {
                paypal.Buttons({
                    createOrder: (data, actions) => actions.order.create({
                        purchase_units: [{
                            description: description,
                            amount: { value: value },
                            custom_id: userId
                        }]
                    }),
                    onApprove: (data, actions) => actions.order.capture().then(details => {
                        document.body.innerHTML = '<h1>Payment Successful!</h1><p style="text-align:center;">You can now close this tab and return to the extension.</p>';
                    }),
                    onError: err => {
                        messageEl.textContent = "An error occurred with your payment. Please try again.";
                        messageEl.style.color = "red";
                        console.error("PayPal Error:", err);
                    }
                }).render(`#${containerId}`);
            }

            renderPayPalButton('paypal-button-container-20', '60 Minute Session', '20.00');
            renderPayPalButton('paypal-button-container-27', '90 Minute Session', '27.00');
            renderPayPalButton('paypal-button-container-36', '120 Minute Session', '36.00');
            renderPayPalButton('paypal-button-container-43', '150 Minute Session', '43.00');
        });
    </script>
</body>
</html>